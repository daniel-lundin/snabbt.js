/*! snabbt.js v0.3.0 built: 2015-01-15 */
!function(a,b){"object"==typeof exports?module.exports=b().snabbt:"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b().snabbt}):a.snabbt=b().snabbt}(this,function(){var a=a||{};a.Animation=function(b){this._startState=b.startState,this._endState=b.endState,this.offset=b.offset,this.duration=b.duration||500,this.delay=b.delay||0,this.easing=a.createEaser("linear"),this.perspective=b.perspective,b.easing&&(this.easing=a.createEaser(b.easing,b)),this._currentState=this._startState.clone();var c=this._currentState,d=this._endState;b.offset&&(c.offsetX=this.offset[0],c.offsetY=this.offset[1],c.offsetZ=this.offset[2],d.offsetX=this.offset[0],d.offsetY=this.offset[1],d.offsetZ=this.offset[2]),this.startTime=0,this.currentTime=0,this._stopped=!1},a.Animation.prototype.stop=function(){this._stopped=!0},a.Animation.prototype.stopped=function(){return this._stopped},a.Animation.prototype.tick=function(a){var b=this.startTime,c=this.currentTime,d=this.delay,e=this.duration;if(!this._stopped){b||(this.startTime=b=a),a-b>d&&(this.currentTime=c=a-d);var f=Math.min(Math.max(0,c-b),e);this.easing.tick(f/e),this.updateCurrentTransform()}},a.Animation.prototype.currentState=function(){return this._currentState},a.Animation.prototype.updateCurrentTransform=function(){var b=this.easing.value();a.TweenStates(this._startState,this._endState,this._currentState,b)},a.Animation.prototype.completed=function(){return this._stopped?!0:0===this.startTime?!1:this.easing.completed()},a.Animation.prototype.updateElement=function(b){var c=this._currentState.asMatrix(),d=this._currentState.properties();a.updateElementTransform(b,c,this.perspective),a.updateElementProperties(b,d)},a.ValueFeededAnimation=function(b){this.valueFeeder=b.valueFeeder,this.duration=b.duration||500,this.delay=b.delay||0,this.perspective=b.perspective,this.easing=a.createEaser("linear"),b.easing&&(this.easing=a.createEaser(b.easing,b)),this._currentState=new a.State({}),this.currentMatrix=this.valueFeeder(0,new a.Matrix),this.startTime=0,this.currentTime=0,this._stopped=!1},a.ValueFeededAnimation.prototype.stop=function(){this._stopped=!0},a.ValueFeededAnimation.prototype.stopped=function(){return this._stopped},a.ValueFeededAnimation.prototype.tick=function(a){if(!this._stopped){this.startTime||(this.startTime=a),a-this.startTime>this.delay&&(this.currentTime=a-this.delay);var b=Math.min(Math.max(.001,this.currentTime-this.startTime),this.duration);this.easing.tick(b/this.duration),this.updateCurrentTransform()}},a.ValueFeededAnimation.prototype.currentState=function(){return this._currentState},a.ValueFeededAnimation.prototype.updateCurrentTransform=function(){var a=this.easing.value(),b=this.currentMatrix;b.clear(),this.currentMatrix=this.valueFeeder(a,b)},a.ValueFeededAnimation.prototype.completed=function(){return this._stopped?!0:this.easing.completed()},a.ValueFeededAnimation.prototype.updateElement=function(b){a.updateElementTransform(b,this.currentMatrix.data,this.perspective)},a.AttentionAnimation=function(b){this.movement=b.movement,this.currentMovement=new a.State({}),b.initialVelocity=.1,b.equilibriumPosition=0,this.spring=new a.SpringEasing(b),this._stopped=!1},a.AttentionAnimation.prototype.stop=function(){this._stopped=!0},a.AttentionAnimation.prototype.stopped=function(){return this._stopped},a.AttentionAnimation.prototype.tick=function(){var a=this.spring;this._stopped||a.equilibrium||(a.tick(),this.updateMovement())},a.AttentionAnimation.prototype.updateMovement=function(){var a=this.currentMovement,b=this.movement,c=this.spring.position;a.x=b.x*c,a.y=b.y*c,a.z=b.z*c,a.ax=b.ax*c,a.ay=b.ay*c,a.az=b.az*c,a.bx=b.bx*c,a.by=b.by*c,a.bz=b.bz*c},a.AttentionAnimation.prototype.updateElement=function(b){var c=this.currentMovement,d=c.asMatrix(),e=c.properties();a.updateElementTransform(b,d),a.updateElementProperties(b,e)},a.AttentionAnimation.prototype.currentState=function(){return this.currentMovement},a.AttentionAnimation.prototype.completed=function(){return this.spring.equilibrium||this._stopped},a.createAnimation=function(b){return b.valueFeeder?new a.ValueFeededAnimation(b):new a.Animation(b)};var a=a||{};a.linearEasing=function(a){return a},a.ease=function(a){return(Math.cos(a*Math.PI+Math.PI)+1)/2},a.easeIn=function(a){return a*a},a.easeOut=function(a){return-Math.pow(a-1,2)+1},a.SpringEasing=function(b){var c=a.optionOrDefault;this.position=c(b.startPosition,0),this.equilibriumPosition=c(b.equilibriumPosition,1),this.velocity=c(b.initialVelocity,0),this.springConstant=c(b.springConstant,.8),this.deceleration=c(b.springDeceleration,.9),this.mass=c(b.springMass,10),this.equilibrium=!1},a.SpringEasing.prototype.tick=function(a){if(0!==a&&!this.equilibrium){var b=-(this.position-this.equilibriumPosition)*this.springConstant,c=b/this.mass;this.velocity+=c,this.position+=this.velocity,this.velocity*=this.deceleration,Math.abs(this.position-this.equilibriumPosition)<.001&&Math.abs(this.velocity)<.001&&(this.equilibrium=!0)}},a.SpringEasing.prototype.value=function(){return this.position},a.SpringEasing.prototype.completed=function(){return this.equilibrium},a.EASING_FUNCS={linear:a.linearEasing,ease:a.ease,easeIn:a.easeIn,easeOut:a.easeOut},a.Easer=function(a){this.easer=a,this._value=0},a.Easer.prototype.tick=function(a){this._value=this.easer(a),this.lastValue=a},a.Easer.prototype.value=function(){return this._value},a.Easer.prototype.completed=function(){return this.lastValue>=1},a.createEaser=function(b,c){if("spring"==b)return new a.SpringEasing(c);var d;return d=a.isFunction(b)?b:a.EASING_FUNCS[b],new a.Easer(d)},window.jQuery&&!function(b){b.fn.snabbt=function(b,c){return a.snabbt(this.get(),b,c)}}(jQuery);var a=a||{};a.snabbt=function(b,c,d){var e=b;if(Array.isArray(e)){for(var f={chainers:[],then:function(a){for(var b=this.chainers,c=this.chainers.length,d=0;c>d;++d)b[d].then(a);return f}},g=0,h=e.length;h>g;++g)f.chainers.push(a.snabbtSingleElement(e[g],c,d));return f}return a.snabbtSingleElement(e,c,d)},a.snabbtSingleElement=function(b,c,d){function e(b){return k.tick(b),k.updateElement(f),k.stopped()?void 0:k.completed()?void(g.loop>1&&!k.stopped()?(g.loop-=1,k=a.createAnimation(j),a.requestAnimationFrame(e)):(g.callback&&g.callback(),l.length&&(g=l.pop(),h=a.stateFromFromOptions(i,g),i=a.stateFromOptions(new a.State({}),g),a.setupAnimationOptions(h,i,g),k=new a.Animation(g),a.runningAnimations.push([f,k]),k.tick(b),a.requestAnimationFrame(e)))):a.requestAnimationFrame(e)}if("attention"===c)return a.setupAttentionAnimation(b,d);if("stop"===c)return a.stopAnimation(b);var f=b,g=c;a.clearOphanedEndStates();var h=a.currentAnimationState(f);h=a.stateFromFromOptions(h,g);var i=new a.State({});i=a.stateFromOptions(i,g);var j=a.setupAnimationOptions(h,i,g),k=a.createAnimation(j);a.runningAnimations.push([f,k]),k.updateElement(f);var l=[],m={then:function(a){return l.unshift(a),m}};return a.requestAnimationFrame(e),m},a.setupAttentionAnimation=function(b,c){function d(c){f.tick(c),f.updateElement(b),f.completed()||a.requestAnimationFrame(d)}var e=a.stateFromOptions(new a.State({}),c);c.movement=e;var f=new a.AttentionAnimation(c);a.runningAnimations.push([b,f]),a.requestAnimationFrame(d)},a.stopAnimation=function(b){for(var c=a.runningAnimations,d=0,e=c.length;e>d;++d){var f=c[d],g=f[0],h=f[1];g===b&&h.stop()}},a.findAnimationState=function(a,b){for(var c=0,d=a.length;d>c;++c){var e=a[c],f=e[0],g=e[1];if(f===b){var h=g.currentState();return g.stop(),h}}},a.currentAnimationState=function(b){var c=a.findAnimationState(a.runningAnimations,b);return c?c:a.findAnimationState(a.completedAnimations,b)},a.stateFromOptions=function(b,c){b||(b=new a.State({}));var d=c.position,e=c.rotation,f=c.skew,g=c.rotationPost,h=c.scale,i=c.width,j=c.height,k=c.opacity;return d&&(b.x=d[0],b.y=d[1],b.z=d[2]),e&&(b.ax=e[0],b.ay=e[1],b.az=e[2]),f&&(b.skewX=f[0],b.skewY=f[1]),g&&(b.bx=g[0],b.by=g[1],b.bz=g[2]),h&&(b.sx=h[0],b.sy=h[1]),void 0!==i&&(b.width=i),void 0!==j&&(b.height=j),void 0!==k&&(b.opacity=k),b},a.stateFromFromOptions=function(b,c){var d=c.fromPosition,e=c.fromRotation,f=c.fromSkew,g=c.fromRotationPost,h=c.fromScale,i=c.fromWidth,j=c.fromHeight,k=c.fromOpacity;return b||(b=new a.State({})),d&&(b.x=d[0],b.y=d[1],b.z=d[2]),e&&(b.ax=e[0],b.ay=e[1],b.az=e[2]),f&&(b.skewX=f[0],b.skewY=f[1]),g&&(b.bx=g[0],b.by=g[1],b.bz=g[2]),h&&(b.sx=h[0],b.sy=h[1]),void 0!==i&&(b.width=i),void 0!==j&&(b.height=j),void 0!==k&&(b.opacity=k),b},a.setupAnimationOptions=function(a,b,c){return c.startState=a,c.endState=b,c},a.tickRequests=[],a.runningAnimations=[],a.completedAnimations=[],a.requestAnimationFrame=function(b){a.tickRequests.push(b)},a.tickAnimations=function(b){for(var c=a.tickRequests,d=c.length,e=0;d>e;++e)c[e](b);c.splice(0,d),window.requestAnimationFrame(a.tickAnimations);var f=a.runningAnimations.filter(function(a){return a[1].completed()});a.completedAnimations=a.completedAnimations.filter(function(a){for(var b=0,c=f.length;c>b;++b)if(a[0]===f[b][0])return!1;return!0}),a.completedAnimations=a.completedAnimations.concat(f),a.runningAnimations=a.runningAnimations.filter(function(a){return!a[1].completed()})},a.clearOphanedEndStates=function(){a.completedAnimations=a.completedAnimations.filter(function(b){return a.findUltimateAncestor(b[0]).body})},a.findUltimateAncestor=function(a){for(var b=a;b.parentNode;)b=b.parentNode;return b},window.requestAnimationFrame(a.tickAnimations);var a=a||{};a.assignTranslate=function(a,b,c,d){a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=b,a[13]=c,a[14]=d,a[15]=1},a.assignRotateX=function(a,b){a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=Math.cos(b),a[6]=-Math.sin(b),a[7]=0,a[8]=0,a[9]=Math.sin(b),a[10]=Math.cos(b),a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1},a.assignRotateY=function(a,b){a[0]=Math.cos(b),a[1]=0,a[2]=Math.sin(b),a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=-Math.sin(b),a[9]=0,a[10]=Math.cos(b),a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1},a.assignRotateZ=function(a,b){a[0]=Math.cos(b),a[1]=-Math.sin(b),a[2]=0,a[3]=0,a[4]=Math.sin(b),a[5]=Math.cos(b),a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1},a.assignSkew=function(a,b,c){a[0]=1,a[1]=Math.tan(b),a[2]=0,a[3]=0,a[4]=Math.tan(c),a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1},a.assignScale=function(a,b,c){a[0]=b,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=c,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1},a.assignIdentity=function(a){a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1},a.copyArray=function(a,b){b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]},a.Matrix=function(){this.data=new Float32Array(16),this.a=new Float32Array(16),this.b=new Float32Array(16),a.assignIdentity(this.data)},a.Matrix.prototype.clear=function(){a.assignIdentity(this.data)},a.Matrix.prototype.translate=function(b,c,d){return a.copyArray(this.data,this.a),a.assignTranslate(this.b,b,c,d),a.assignedMatrixMultiplication(this.a,this.b,this.data),this},a.Matrix.prototype.rotateX=function(b){return a.copyArray(this.data,this.a),a.assignRotateX(this.b,b),a.assignedMatrixMultiplication(this.a,this.b,this.data),this},a.Matrix.prototype.rotateY=function(b){return a.copyArray(this.data,this.a),a.assignRotateY(this.b,b),a.assignedMatrixMultiplication(this.a,this.b,this.data),this},a.Matrix.prototype.rotateZ=function(b){return a.copyArray(this.data,this.a),a.assignRotateZ(this.b,b),a.assignedMatrixMultiplication(this.a,this.b,this.data),this},a.Matrix.prototype.scale=function(b,c){return a.copyArray(this.data,this.a),a.assignScale(this.b,b,c),a.assignedMatrixMultiplication(this.a,this.b,this.data),this},a.Matrix.prototype.skew=function(b,c){return a.copyArray(this.data,this.a),a.assignSkew(this.b,b,c),a.assignedMatrixMultiplication(this.a,this.b,this.data),this},a.assignedMatrixMultiplication=function(a,b,c){return c[0]=a[0]*b[0]+a[1]*b[4]+a[2]*b[8]+a[3]*b[12],c[1]=a[0]*b[1]+a[1]*b[5]+a[2]*b[9]+a[3]*b[13],c[2]=a[0]*b[2]+a[1]*b[6]+a[2]*b[10]+a[3]*b[14],c[3]=a[0]*b[3]+a[1]*b[7]+a[2]*b[11]+a[3]*b[15],c[4]=a[4]*b[0]+a[5]*b[4]+a[6]*b[8]+a[7]*b[12],c[5]=a[4]*b[1]+a[5]*b[5]+a[6]*b[9]+a[7]*b[13],c[6]=a[4]*b[2]+a[5]*b[6]+a[6]*b[10]+a[7]*b[14],c[7]=a[4]*b[3]+a[5]*b[7]+a[6]*b[11]+a[7]*b[15],c[8]=a[8]*b[0]+a[9]*b[4]+a[10]*b[8]+a[11]*b[12],c[9]=a[8]*b[1]+a[9]*b[5]+a[10]*b[9]+a[11]*b[13],c[10]=a[8]*b[2]+a[9]*b[6]+a[10]*b[10]+a[11]*b[14],c[11]=a[8]*b[3]+a[9]*b[7]+a[10]*b[11]+a[11]*b[15],c[12]=a[12]*b[0]+a[13]*b[4]+a[14]*b[8]+a[15]*b[12],c[13]=a[12]*b[1]+a[13]*b[5]+a[14]*b[9]+a[15]*b[13],c[14]=a[12]*b[2]+a[13]*b[6]+a[14]*b[10]+a[15]*b[14],c[15]=a[12]*b[3]+a[13]*b[7]+a[14]*b[11]+a[15]*b[15],c},a.matrixToCSS=function(a){for(var b="matrix3d(",c=0;15>c;++c)b+=Math.abs(a[c])<1e-4?"0,":a[c].toFixed(10)+",";return b+=Math.abs(a[15])<1e-4?"0)":a[15].toFixed(10)+")"},a.setCSS=function(b,c){b.style.webkitTransform=a.matrixToCSS(c),b.style.transform=a.matrixTCSS(c)},a.State=function(b){var c=a.optionOrDefault;this.ax=c(b.ax,0),this.ay=c(b.ay,0),this.az=c(b.az,0),this.x=c(b.x,0),this.y=c(b.y,0),this.z=c(b.z,0),this.bx=c(b.bx,0),this.by=c(b.by,0),this.bz=c(b.bz,0),this.skewX=c(b.skewX,0),this.skewY=c(b.skewY,0),this.offsetX=c(b.offsetX,0),this.offsetY=c(b.offsetY,0),this.offsetZ=c(b.offsetZ,0),this.sx=c(b.sx,1),this.sy=c(b.sy,1),this.width=b.width,this.height=b.height,this.opacity=c(b.opacity,1)},a.State.prototype.clone=function(){var b=new a.State({ax:this.ax,ay:this.ay,az:this.az,x:this.x,y:this.y,z:this.z,bx:this.bx,by:this.by,bz:this.bz,skewX:this.skewX,skewY:this.skewY,sx:this.sx,sy:this.sy,height:this.height,width:this.width,opacity:this.opacity});return b},a.State.prototype.asMatrix=function(){var b=new a.Matrix;return b.translate(this.offsetX,this.offsetY,this.offsetZ),b.scale(this.sx,this.sy),b.skew(this.skewX,this.skewY),b.rotateX(this.ax),b.rotateY(this.ay),b.rotateZ(this.az),b.translate(this.x,this.y,this.z),b.rotateX(this.bx),b.rotateY(this.by),b.rotateZ(this.bz),b.data},a.State.prototype.properties=function(){return{opacity:this.opacity,width:this.width+"px",height:this.height+"px"}};var a=a||{};a.TweenStates=function(a,b,c,d){var e=b.x-a.x,f=b.y-a.y,g=b.z-a.z,h=b.ax-a.ax,i=b.ay-a.ay,j=b.az-a.az,k=b.bx-a.bx,l=b.by-a.by,m=b.bz-a.bz,n=b.sx-a.sx,o=b.sy-a.sy,p=b.skewX-a.skewX,q=b.skewY-a.skewY,r=b.width-a.width,s=b.height-a.height,t=b.opacity-a.opacity;c.ax=a.ax+d*h,c.ay=a.ay+d*i,c.az=a.az+d*j,c.x=a.x+d*e,c.y=a.y+d*f,c.z=a.z+d*g,c.bx=a.bx+d*k,c.by=a.by+d*l,c.bz=a.bz+d*m,c.skewX=a.skewX+d*p,c.skewY=a.skewY+d*q,c.sx=a.sx+d*n,c.sy=a.sy+d*o,void 0!==b.width&&(c.width=a.width+d*r),void 0!==b.height&&(c.height=a.height+d*s),void 0!==b.opacity&&(c.opacity=a.opacity+d*t)};var a=a||{};return a.optionOrDefault=function(a,b){return"undefined"==typeof a?b:a},a.updateElementTransform=function(b,c,d){var e="";d&&(e="perspective("+d+"px) "),b.style.webkitTransform=e+a.matrixToCSS(c),b.style.transform=e+a.matrixToCSS(c)},a.updateElementProperties=function(a,b){for(var c in b)a.style[c]=b[c]},a.isFunction=function(a){return"function"==typeof a},a});